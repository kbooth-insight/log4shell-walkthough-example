FROM --

FROM  --paltform linux/amd64 docker.io/adoptopenjdk/openjdk8:x86_64-ubuntu-jdk8u172-b11 as openjdk

FROM --platform= inux/amd64 python:3.9-slim-bullseye as python
# taking lazy way
COPY --from=openjdk /opt/java/openjdk /opt/java/openjdk/
COPY --from=openjdk /lib64/ld-linux-x86-64.so.2 /lib64/
COPY --from=openjdk /lib/x86_64-linux-gnu/libpthread* /lib/x86_64-linux-gnu/libm.so.6 /lib/x86_64-linux-gnu/libdl.so.2 /lib/x86_64-linux-gnu/libc.so.6 /lib/x86_64-linux-gnu/libm.so.6 /lib/x86_64-linux-gnu/

WORKDIR /opt/ldap
COPY ./target requirements.txt ./target/
COPY poc.py requirements.txt ./
RUN pip3 install -r requirements.txt

EXPOSE 1389
EXPOSE 8000
COPY ./run.sh /
ENTRYPOINT ["/run.sh"]